import{p as e,y as r,a5 as t,cz as s,c0 as i,aD as o,bO as a,q as n,cf as l,cA as u,aB as p,a as c,bM as y,U as d,L as m,cB as f}from"../main.js";import{c as h,n as B,e as g}from"./NAMessage-74834804.js";import{c as v}from"./DirectionsFeatureSet-15de9052.js";import"./GPMessage-0b666089.js";function b(e){return u.fromJSON(e).features.map((e=>e.geometry))}let A=class extends l{constructor(e){super(e),this.directions=null,this.facilities=null,this.incidents=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routes=null}readFacilities(e){return b(e)}readIncidents(e){return b(e)}readPointBarriers(e,r){return b(r.barriers)}readPolylineBarriers(e){return b(e)}readPolygonBarriers(e){return b(e)}readRoutes(e){return function(e){return e.features.map((r=>{const t=p.fromJSON(e.spatialReference),s=a.fromJSON(r);return c(s.geometry)&&(s.geometry.spatialReference=t),s}))}(e)}};e([r({type:[v]})],A.prototype,"directions",void 0),e([r({type:[t]})],A.prototype,"facilities",void 0),e([s("facilities")],A.prototype,"readFacilities",null),e([r({type:[t]})],A.prototype,"incidents",void 0),e([s("incidents")],A.prototype,"readIncidents",null),e([r({type:[h]})],A.prototype,"messages",void 0),e([r({type:[t]})],A.prototype,"pointBarriers",void 0),e([s("pointBarriers",["barriers"])],A.prototype,"readPointBarriers",null),e([r({type:[i]})],A.prototype,"polylineBarriers",void 0),e([s("polylineBarriers")],A.prototype,"readPolylineBarriers",null),e([r({type:[o]})],A.prototype,"polygonBarriers",void 0),e([s("polygonBarriers")],A.prototype,"readPolygonBarriers",null),e([r({type:[a]})],A.prototype,"routes",void 0),e([s("routes")],A.prototype,"readRoutes",null),A=e([n("esri.tasks.support.ClosestFacilitySolveResult")],A);var P=A;const R=g({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},facilities:!0,incidents:!0,outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},returnPointBarriers:{name:"returnBarriers"},returnRoutes:{name:"returnCFRoutes"},travelMode:!0});let S=class extends(B(f)){constructor(e){super(e),this.url=null}solve(e,r){const t=[],s=[],i={},o={};return e.incidents&&e.incidents.features&&this._collectGeometries(e.incidents.features,s,"incidents.features",i),e.facilities&&e.facilities.features&&this._collectGeometries(e.facilities.features,s,"facilities.features",i),e.pointBarriers&&e.pointBarriers.features&&this._collectGeometries(e.pointBarriers.features,s,"pointBarriers.features",i),e.polylineBarriers&&e.polylineBarriers.features&&this._collectGeometries(e.polylineBarriers.features,s,"polylineBarriers.features",i),e.polygonBarriers&&e.polygonBarriers.features&&this._collectGeometries(e.polygonBarriers.features,s,"polygonBarriers.features",i),y(s).then((e=>{for(const r in i){const s=i[r];t.push(r),o[r]=e.slice(s[0],s[1])}return this._isInputGeometryZAware(o,t)?this.getServiceDescription():d({dontCheck:!0})})).then((s=>{("dontCheck"in s?s.dontCheck:s.hasZ)||this._dropZValuesOffInputGeometry(o,t);for(const r in o)o[r].forEach(((t,s)=>{e.get(r)[s].geometry=t}));let i={query:{...this.parsedUrl.query,f:"json",...R.toQueryParams(e)}};return(this.requestOptions||r)&&(i={...this.requestOptions,...r,...i}),m(this.parsedUrl.path+"/solveClosestFacility",i)})).then((e=>P.fromJSON(e.data)))}_collectGeometries(e,r,t,s){s[t]=[r.length,r.length+e.length],e.forEach((e=>{r.push(e.geometry)}))}};e([r()],S.prototype,"url",void 0),S=e([n("esri.tasks.ClosestFacilityTask")],S);var G=S;export default G;
