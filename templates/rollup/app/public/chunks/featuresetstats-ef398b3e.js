import{U as n,v as t,bo as r}from"../main.js";import{P as e,Z as i,n as u,w as a,r as o,ai as c,K as s}from"./arcadeUtils-f665f7ae.js";import"./number-c01be8dd.js";import"./featureConversionUtils-0e5f7c52.js";import"./centroid-aa1305d6.js";import"./FeatureSetReader-b7349ae0.js";import{WhereClause as f}from"./WhereClause-5e802398.js";function d(t,r,e,a,d,m){if(1===a.length){if(u(a[0]))return n(c(t,a[0],s(a[1],-1)));if(o(a[0]))return n(c(t,a[0].toArray(),s(a[1],-1)))}else if(2===a.length){if(u(a[0]))return n(c(t,a[0],s(a[1],-1)));if(o(a[0]))return n(c(t,a[0].toArray(),s(a[1],-1)));if(i(a[0]))return a[0].load().then((n=>l(f.create(a[1],n.getFieldsIndex()),m,d).then((n=>a[0].calculateStatistic(t,n,s(a[2],1e3),r.abortSignal)))))}else if(3===a.length&&i(a[0]))return a[0].load().then((n=>l(f.create(a[1],n.getFieldsIndex()),m,d).then((n=>a[0].calculateStatistic(t,n,s(a[2],1e3),r.abortSignal)))));return n(c(t,a,-1))}function l(e,i,u){try{const r=e.getVariables();if(r.length>0){const n=[];for(let t=0;t<r.length;t++){const e={name:r[t]};n.push(i.evaluateIdentifier(u,e))}return t(n).then((n=>{const t={};for(let e=0;e<r.length;e++)t[r[e]]=n[e];return e.parameters=t,e}))}return n(e)}catch(n){return r(n)}}function m(n){"async"===n.mode&&(n.functions.stdev=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,i){return d("stdev",r,0,i,t,n)}))},n.functions.variance=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,i){return d("variance",r,0,i,t,n)}))},n.functions.average=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,i){return d("mean",r,0,i,t,n)}))},n.functions.mean=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,i){return d("mean",r,0,i,t,n)}))},n.functions.sum=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,i){return d("sum",r,0,i,t,n)}))},n.functions.min=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,i){return d("min",r,0,i,t,n)}))},n.functions.max=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,i){return d("max",r,0,i,t,n)}))},n.functions.count=function(t,r){return n.standardFunctionAsync(t,r,(function(n,t,r){if(e(r,1,1),i(r[0]))return r[0].count(n.abortSignal);if(u(r[0])||a(r[0]))return r[0].length;if(o(r[0]))return r[0].length();throw new Error("Invalid Parameters for Count")}))})}export{m as registerFunctions};
